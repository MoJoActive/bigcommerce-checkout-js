"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[964],{44713:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var r=n(31635),s=n(69440),i=n(70355),a=n(49655),o=n(17986),l=n(39886),d=n(95108),u=n(45293),c=n(79001),m=n(84559),g=n(87980),p=n(74027),h=n(43586),A=n(38190),f=n(2030),v=n(68512),b=n(38989),E=n(69022),C=n(68801),_=n(87650),y=n(49102),k=n(62562),S=n(12319),w=n(22011),F=n(33515),B=n(10685),I=n(69070),M=n(46487),L=n(4899),N=n(60833),U=n(74302);const z=(0,v.A)((0,A.bk)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,s=e.billingAddress;return(0,r.__assign)((0,r.__assign)({},(0,w.A)(t(s&&s.countryCode),s)),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,r=e.language;return!!t&&(0,F.A)({language:r,formFields:n(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields;return"amazonpay"===e.methodId?(0,f.RZ)((function(e){return(0,B.A)({translate:(0,F.X)(t),formFields:n(e&&e.countryCode)})})):(0,f.RZ)((function(e){return(0,F.A)({language:t,formFields:n(e&&e.countryCode)})}))},enableReinitialize:!0})((function(e){var t=e.googleMapsApiKey,n=e.billingAddress,s=e.countriesWithAutocomplete,l=e.customer,d=l.addresses,u=l.isGuest,c=e.getFields,m=e.countries,g=e.isUpdating,p=e.setFieldValue,h=e.shouldShowOrderComments,A=e.values,f=e.methodId,v=e.isFloatingLabelEnabled,w=e.updateAddress,F=e.onUnhandledError,B=(0,i.useState)(!1),z=B[0],V=B[1],O=(0,i.useRef)(null),K=(0,b.A)(),P=K.isPayPalFastlaneEnabled,R=K.paypalFastlaneAddresses,x=(0,E.w)().themeV2,T="amazonpay"===f,W=c(A.countryCode),Z=W.filter((function(e){return e.custom})),D=Z.length>0,G=T&&D?Z:W,J=u&&P?R:d,H=(null==J?void 0:J.length)>0,X=n&&(0,_.A)(n,J,c(n.countryCode)),j=function(e){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:V(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,w(e)];case 2:return n.sent(),[3,5];case 3:return(t=n.sent())instanceof Error&&F(t),[3,5];case 4:return V(!1),[7];case 5:return[2]}}))}))};return i.createElement(L.A,{autoComplete:"on"},T&&n&&i.createElement("div",{className:"form-fieldset"},i.createElement(U.A,{address:n})),i.createElement(N.A,{id:"checkoutBillingAddress",ref:O},H&&!T&&i.createElement(N.A,{id:"billingAddresses"},i.createElement(C.A,{isLoading:z},i.createElement(y.A,{addresses:J,onSelectAddress:j,onUseNewAddress:function(){j({})},selectedAddress:X?n:void 0,type:k.A.Billing}))),!X&&i.createElement(o.A,{isLoading:z},i.createElement(S.A,{countries:m,countriesWithAutocomplete:s,countryCode:A.countryCode,formFields:G,googleMapsApiKey:t,isFloatingLabelEnabled:v,setFieldValue:p,shouldShowSaveAddress:!u}))),h&&i.createElement(I.A,null),i.createElement("div",{className:"form-actions"},i.createElement(M.Ay,{className:x?"body-bold":"",disabled:g||z,id:"checkout-billing-continue",isLoading:g||z,type:"submit",variant:M.Ak.Primary},i.createElement(a.A,{id:"common.continue_action"}))))})));var V=n(21106);function O(e){var t=(0,V.A)(e);return t&&["amazonpay"].includes(t.providerId)?t.providerId:void 0}var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return(0,r.__awaiter)(t,void 0,void 0,(function(){var t,n,s,i,a,o,u,c,m,g,p=e.orderComment,h=(0,r.__rest)(e,["orderComment"]);return(0,r.__generator)(this,(function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,s=t.updateCheckout,i=t.customerMessage,a=t.billingAddress,o=t.navigateNextStep,u=t.onUnhandledError,c=[],(m=(0,l.A)(h))&&!(0,d.A)(m,a)&&c.push(n(m)),i!==p&&c.push(s({customerMessage:p})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(c)];case 2:return e.sent(),o(),[3,4];case 3:return(g=e.sent())instanceof Error&&u(g),[3,4];case 4:return[2]}}))}))},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,a,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:e=this.props,t=e.initialize,n=e.onReady,i=void 0===n?s.noop:n,a=e.onUnhandledError,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t()];case 2:return r.sent(),i(),[3,4];case 3:return(o=r.sent())instanceof Error&&a(o),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,s=e.themeV2,l=(0,r.__rest)(e,["updateAddress","isInitializing","themeV2"]);return i.createElement(o.A,{isLoading:n},i.createElement("div",{className:"checkout-form"},i.createElement("div",{className:"form-legend-container"},i.createElement(h.A,{testId:"billing-address-heading",themeV2:s},i.createElement(a.A,{id:"billing.billing_address_heading"}))),i.createElement(z,(0,r.__assign)({},l,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(i.Component);const P=(0,u.A)((function(e){var t=e.checkoutService,n=e.checkoutState,r=n.data,s=r.getCheckout,i=r.getConfig,a=r.getCart,o=r.getCustomer,l=r.getBillingAddress,d=r.getBillingAddressFields,u=r.getBillingCountries,h=n.statuses,A=h.isLoadingBillingCountries,f=h.isUpdatingBillingAddress,v=h.isUpdatingCheckout,b=i(),E=o(),C=s(),_=a();if(!(b&&E&&C&&_))return null;var y=b.checkoutSettings,k=y.enableOrderComments,S=y.googleMapsApiKey;return{billingAddress:l(),countries:u()||c.M,countriesWithAutocomplete:["US","CA","AU","NZ","GB"],customer:E,customerMessage:C.customerMessage,getFields:d,googleMapsApiKey:S,initialize:t.loadBillingAddressFields,isInitializing:A(),isUpdating:f()||v(),methodId:O(C),shouldShowOrderComments:k&&(0,p.A)(_)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout,isFloatingLabelEnabled:(0,m.A)(b.checkoutSettings),themeV2:(0,g.A)(b.checkoutSettings,"CHECKOUT-7962.update_font_style_on_checkout_page")}}))(K)},67113:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(31635),s=n(70355),i=n(6289),a=n(91605);const o=function(e){var t=e.placement,n=void 0===t?"bottom-start":t,o=e.dropdown,l=e.children,d=(0,s.useState)(!1),u=d[0],c=d[1],m=(0,s.useCallback)((function(){return document.getElementById(a.B)||document.getElementById(a.S)}),[]),g=(0,s.useCallback)((function(){u&&c(!1)}),[u]),p=(0,s.useCallback)((function(){u||c(!0)}),[u]),h=(0,s.useCallback)((function(){u?g():p()}),[u,g,p]);return(0,s.useEffect)((function(){var e=m();return u?null==e||e.addEventListener("click",g):null==e||e.removeEventListener("click",g),function(){null==e||e.removeEventListener("click",g)}}),[u,g,m]),s.createElement(i.mS,null,s.createElement(i.Or,null,(function(e){var t=e.ref;return s.createElement("div",{className:"dropdownTrigger",onClick:h,ref:t},l)})),s.createElement(i.ND,{modifiers:[{name:"hide",enabled:!1},{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}],placement:n},(function(e){var t=e.ref,n=e.style;return u?s.createElement("div",{className:"dropdownMenu",ref:t,style:(0,r.__assign)((0,r.__assign)({},n),{width:"100%",zIndex:1})},o):null})))}},91605:(e,t,n)=>{n.d(t,{B:()=>r,S:()=>s});var r="checkout-app",s="micro-app-ng-checkout"}}]);
//# sourceMappingURL=billing-139360bd.js.map