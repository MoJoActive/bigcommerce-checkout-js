{"version":3,"file":"hosted-credit-card-payment-method-7788d119.js","mappings":"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","sources":["webpack://checkout/./packages/hosted-credit-card-integration/src/HostedCreditCardPaymentMethod.tsx","webpack://checkout/./packages/hosted-credit-card-integration/src/hooks/useHostedCreditCard.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/getCreditCardInputStyles.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardCustomerCodeField.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/InstrumentSelect.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/CardInstrumentFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardCodeRequired.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardCodeRequiredSelector.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardNumberRequiredSelector.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardNumberRequired.ts","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/getHostedCreditCardValidationSchema.ts","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/getHostedInstrumentValidationSchema.ts","webpack://checkout/./packages/core/src/app/ui/form/TextInputIframeContainer.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconLock.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconHelp.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconCardCodeVisa.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconCardCodeAmex.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardCodeTooltip.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardCodeField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardExpiryField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardNameField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardNumberField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardValidation.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/withHostedCreditCardFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardCodeField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardExpiryField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/formatCreditCardExpiryDate.ts","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardNameField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardNumberField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/formatCreditCardNumber.ts","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/getCreditCardValidationSchema.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/CreditCardValidation.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/getInstrumentValidationSchema.ts","webpack://checkout/./packages/core/src/app/payment/paymentMethod/CreditCardPaymentMethod.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/configureCardValidator.ts","webpack://checkout/./packages/core/src/app/payment/paymentMethod/HostedCreditCardPaymentMethod.tsx"],"sourcesContent":["import React, { type FunctionComponent } from 'react';\n\nimport {\n    type PaymentMethodProps,\n    type PaymentMethodResolveId,\n    toResolvableComponent,\n} from '@bigcommerce/checkout/payment-integration-api';\n\nimport { HostedCreditCardComponent } from './components';\n\nconst HostedCreditCardPaymentMethod: FunctionComponent<PaymentMethodProps> = ({\n    method,\n    checkoutService,\n    checkoutState,\n    paymentForm,\n    language,\n    onUnhandledError,\n}) => {\n    return (\n        <HostedCreditCardComponent\n            checkoutService={checkoutService}\n            checkoutState={checkoutState}\n            language={language}\n            method={method}\n            onUnhandledError={onUnhandledError}\n            paymentForm={paymentForm}\n        />\n    );\n};\n\nexport default toResolvableComponent<PaymentMethodProps, PaymentMethodResolveId>(\n    HostedCreditCardPaymentMethod,\n    [\n        {\n            id: 'hosted-credit-card',\n        },\n        { id: 'credit_card', gateway: 'bluesnapdirect' },\n        { id: 'credit_card', gateway: 'checkoutcom' },\n\n        { id: 'tdonlinemart' },\n    ],\n);\n","import {\n    type CardInstrument,\n    type CheckoutSelectors,\n    type LanguageService,\n    type LegacyHostedFormOptions,\n    type PaymentMethod,\n} from '@bigcommerce/checkout-sdk';\nimport { compact, forIn } from 'lodash';\nimport React, { type ReactNode, useCallback, useState } from 'react';\n\nimport {\n    CreditCardInputStylesType,\n    getCreditCardInputStyles,\n    isInstrumentCardCodeRequiredSelector,\n    isInstrumentCardNumberRequiredSelector,\n} from '@bigcommerce/checkout/instrument-utils';\nimport { type PaymentFormService } from '@bigcommerce/checkout/payment-integration-api';\n\nimport { HostedCreditCardValidation } from '../components';\n\nexport interface UseHostedFormOptions {\n    checkoutState: CheckoutSelectors;\n    language: LanguageService;\n    method: PaymentMethod;\n    paymentForm: PaymentFormService;\n}\n\nexport const useHostedCreditCard = ({\n    checkoutState,\n    method,\n    language,\n    paymentForm,\n}: UseHostedFormOptions) => {\n    const { setFieldTouched, setFieldValue, setSubmitted, submitForm } = paymentForm;\n    const { config } = method;\n    const { cardCode: requireCardCode } = config;\n\n    const isCardCodeRequired = requireCardCode || requireCardCode === null;\n    const isInstrumentCardCodeRequiredProp = isInstrumentCardCodeRequiredSelector(checkoutState);\n    const isInstrumentCardNumberRequiredProp =\n        isInstrumentCardNumberRequiredSelector(checkoutState);\n\n    const getHostedFieldId: (name: string) => string = useCallback(\n        (name) => {\n            return `${compact([method.gateway, method.id]).join('-')}-${name}`;\n        },\n        [method],\n    );\n\n    const [focusedFieldType, setFocusedFieldType] = useState<string>();\n\n    const getHostedStoredCardValidationFieldset: (selectedInstrument: CardInstrument) => ReactNode =\n        useCallback(\n            (selectedInstrument) => {\n                const isInstrumentCardNumberRequired = selectedInstrument\n                    ? isInstrumentCardNumberRequiredProp(selectedInstrument, method)\n                    : false;\n                const isInstrumentCardCodeRequired = selectedInstrument\n                    ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n                    : false;\n\n                return (\n                    <HostedCreditCardValidation\n                        cardCodeId={\n                            isInstrumentCardCodeRequired ? getHostedFieldId('ccCvv') : undefined\n                        }\n                        cardNumberId={\n                            isInstrumentCardNumberRequired\n                                ? getHostedFieldId('ccNumber')\n                                : undefined\n                        }\n                        focusedFieldType={focusedFieldType}\n                    />\n                );\n            },\n            [\n                focusedFieldType,\n                getHostedFieldId,\n                isInstrumentCardCodeRequiredProp,\n                isInstrumentCardNumberRequiredProp,\n                method,\n            ],\n        );\n\n    const getHostedFormOptions = useCallback(\n        async (selectedInstrument: CardInstrument): Promise<LegacyHostedFormOptions> => {\n            const styleProps = ['color', 'fontFamily', 'fontSize', 'fontWeight'];\n            const isInstrumentCardNumberRequired = selectedInstrument\n                ? isInstrumentCardNumberRequiredProp(selectedInstrument, method)\n                : false;\n            const isInstrumentCardCodeRequired = selectedInstrument\n                ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n                : false;\n            let styleContainerId;\n\n            if (selectedInstrument) {\n                if (isInstrumentCardCodeRequired) {\n                    styleContainerId = getHostedFieldId('ccCvv');\n                } else if (isInstrumentCardNumberRequired) {\n                    styleContainerId = getHostedFieldId('ccNumber');\n                }\n            } else {\n                styleContainerId = getHostedFieldId('ccNumber');\n            }\n\n            return {\n                fields: selectedInstrument\n                    ? {\n                          cardCodeVerification:\n                              isInstrumentCardCodeRequired && selectedInstrument\n                                  ? {\n                                        accessibilityLabel: language.translate(\n                                            'payment.credit_card_cvv_label',\n                                        ),\n                                        containerId: getHostedFieldId('ccCvv'),\n                                        instrumentId: selectedInstrument.bigpayToken,\n                                    }\n                                  : undefined,\n                          cardNumberVerification:\n                              isInstrumentCardNumberRequired && selectedInstrument\n                                  ? {\n                                        accessibilityLabel: language.translate(\n                                            'payment.credit_card_number_label',\n                                        ),\n                                        containerId: getHostedFieldId('ccNumber'),\n                                        instrumentId: selectedInstrument.bigpayToken,\n                                    }\n                                  : undefined,\n                      }\n                    : {\n                          cardCode: isCardCodeRequired\n                              ? {\n                                    accessibilityLabel: language.translate(\n                                        'payment.credit_card_cvv_label',\n                                    ),\n                                    containerId: getHostedFieldId('ccCvv'),\n                                }\n                              : undefined,\n                          cardExpiry: {\n                              accessibilityLabel: language.translate(\n                                  'payment.credit_card_expiration_label',\n                              ),\n                              containerId: getHostedFieldId('ccExpiry'),\n                              placeholder: language.translate(\n                                  'payment.credit_card_expiration_placeholder_text',\n                              ),\n                          },\n                          cardName: {\n                              accessibilityLabel: language.translate(\n                                  'payment.credit_card_name_label',\n                              ),\n                              containerId: getHostedFieldId('ccName'),\n                          },\n                          cardNumber: {\n                              accessibilityLabel: language.translate(\n                                  'payment.credit_card_number_label',\n                              ),\n                              containerId: getHostedFieldId('ccNumber'),\n                          },\n                      },\n                styles: styleContainerId\n                    ? {\n                          default: await getCreditCardInputStyles(styleContainerId, styleProps),\n                          error: await getCreditCardInputStyles(\n                              styleContainerId,\n                              styleProps,\n                              CreditCardInputStylesType.Error,\n                          ),\n                          focus: await getCreditCardInputStyles(\n                              styleContainerId,\n                              styleProps,\n                              CreditCardInputStylesType.Focus,\n                          ),\n                      }\n                    : {},\n                onBlur: ({ fieldType }) => {\n                    if (focusedFieldType === fieldType) {\n                        setFocusedFieldType(undefined);\n                    }\n                },\n                onCardTypeChange: ({ cardType }) => {\n                    setFieldValue('hostedForm.cardType', cardType);\n                },\n                onEnter: () => {\n                    setSubmitted(true);\n                    submitForm();\n                },\n                onFocus: ({ fieldType }) => {\n                    setFocusedFieldType(fieldType);\n                },\n                onValidate: ({ errors = {} }) => {\n                    forIn(errors, (fieldErrors = [], fieldType) => {\n                        const errorKey = `hostedForm.errors.${fieldType}`;\n\n                        setFieldValue(errorKey, fieldErrors[0]?.type ?? '');\n\n                        if (fieldErrors[0]) {\n                            setFieldTouched(errorKey);\n                        }\n                    });\n                },\n            };\n        },\n        [\n            focusedFieldType,\n            getHostedFieldId,\n            isCardCodeRequired,\n            isInstrumentCardCodeRequiredProp,\n            isInstrumentCardNumberRequiredProp,\n            language,\n            method,\n            setFieldTouched,\n            setFieldValue,\n            setSubmitted,\n            submitForm,\n        ],\n    );\n\n    return { getHostedStoredCardValidationFieldset, getHostedFormOptions };\n};\n","import { noop } from 'lodash';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { getAppliedStyles } from '@bigcommerce/checkout/dom-utils';\nimport { FormContext } from '@bigcommerce/checkout/ui';\n\nimport { FormFieldContainer, TextInput } from '../../ui/form';\n\nexport enum CreditCardInputStylesType {\n    Default = 'default',\n    Error = 'error',\n    Focus = 'focus',\n}\n\nexport default function getCreditCardInputStyles(\n    containerId: string,\n    properties: string[],\n    type: CreditCardInputStylesType = CreditCardInputStylesType.Default,\n): Promise<{ [key: string]: string }> {\n    const container = document.createElement('div');\n    const parentContainer = document.getElementById(containerId);\n\n    if (!parentContainer) {\n        throw new Error(\n            'Unable to retrieve input styles as the provided container ID is not valid.',\n        );\n    }\n\n    parentContainer.appendChild(container);\n\n    return new Promise((resolve) => {\n        const callbackRef = (element: HTMLInputElement | null) => {\n            if (!element) {\n                return;\n            }\n\n            resolve(getAppliedStyles(element, properties));\n\n            ReactDOM.unmountComponentAtNode(container);\n\n            if (container.parentElement) {\n                container.parentElement.removeChild(container);\n            }\n        };\n\n        ReactDOM.render(\n            <FormContext.Provider value={{ isSubmitted: true, setSubmitted: noop }}>\n                <FormFieldContainer hasError={type === CreditCardInputStylesType.Error}>\n                    <TextInput\n                        appearFocused={type === CreditCardInputStylesType.Focus}\n                        ref={callbackRef}\n                    />\n                </FormFieldContainer>\n            </FormContext.Provider>,\n            container,\n        );\n    });\n}\n","import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\n\nexport interface CreditCardCustomerCodeFieldProps {\n    name: string;\n}\n\nconst CreditCardCustomerCodeField: FunctionComponent<CreditCardCustomerCodeFieldProps> = ({\n    name,\n}) => {\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => <TextInput {...field} id={field.name} />,\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => (\n            <>\n                <TranslatedString id=\"payment.credit_card_customer_code_label\" />{' '}\n                <small className=\"optimizedCheckout-contentSecondary\">\n                    <TranslatedString id=\"common.optional_text\" />\n                </small>\n            </>\n        ),\n        [],\n    );\n\n    return <FormField input={renderInput} labelContent={labelContent} name={name} />;\n};\n\nexport default memo(CreditCardCustomerCodeField);\n","import { type CardInstrument } from '@bigcommerce/checkout-sdk';\nimport { expirationDate } from 'card-validator';\nimport classNames from 'classnames';\nimport creditCardType from 'credit-card-type';\nimport { type FieldProps } from 'formik';\nimport { find, noop } from 'lodash';\nimport React, { type FunctionComponent, PureComponent, type ReactNode, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { CreditCardIcon } from '@bigcommerce/checkout/ui';\n\nimport { DropdownTrigger } from '../../ui/dropdown';\n\nimport mapFromInstrumentCardType from './mapFromInstrumentCardType';\n\nexport interface InstrumentSelectProps extends FieldProps<string> {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nexport interface InstrumentSelectValues {\n    instrumentId: string;\n}\n\nclass InstrumentSelect extends PureComponent<InstrumentSelectProps> {\n    componentDidMount() {\n        const { selectedInstrumentId } = this.props;\n\n        // FIXME: Used setTimeout here because setFieldValue call doesnot set value if called before formik is properly mounted.\n        //        This ensures that update Field value is called after formik has mounted.\n        // See GitHub issue: https://github.com/jaredpalmer/formik/issues/930\n        setTimeout(() => this.updateFieldValue(selectedInstrumentId));\n    }\n\n    componentDidUpdate(prevProps: Readonly<InstrumentSelectProps>) {\n        const { selectedInstrumentId: prevSelectedInstrumentId } = prevProps;\n        const { selectedInstrumentId } = this.props;\n\n        if (prevSelectedInstrumentId !== selectedInstrumentId) {\n            this.updateFieldValue(selectedInstrumentId);\n        }\n    }\n\n    componentWillUnmount() {\n        const { selectedInstrumentId, field } = this.props;\n\n        if (field.value === '' && selectedInstrumentId !== undefined) {\n            this.updateFieldValue();\n        }\n    }\n\n    render(): ReactNode {\n        const {\n            field,\n            instruments,\n            onSelectInstrument,\n            onUseNewInstrument,\n            selectedInstrumentId,\n            shouldHideExpiryDate = false,\n        } = this.props;\n\n        const selectedInstrument = find(instruments, { bigpayToken: selectedInstrumentId });\n\n        return (\n            <div className=\"instrumentSelect\">\n                <DropdownTrigger\n                    dropdown={\n                        <InstrumentMenu\n                            instruments={instruments}\n                            onSelectInstrument={onSelectInstrument}\n                            onUseNewInstrument={onUseNewInstrument}\n                            selectedInstrumentId={selectedInstrumentId}\n                            shouldHideExpiryDate={shouldHideExpiryDate}\n                        />\n                    }\n                >\n                    <InstrumentSelectButton\n                        instrument={selectedInstrument}\n                        shouldHideExpiryDate={shouldHideExpiryDate}\n                        testId=\"instrument-select\"\n                    />\n\n                    <input type=\"hidden\" {...field} />\n                </DropdownTrigger>\n            </div>\n        );\n    }\n\n    private updateFieldValue(instrumentId = ''): void {\n        const { form, field } = this.props;\n\n        form.setFieldValue(field.name, instrumentId);\n    }\n}\n\ninterface InstrumentMenuProps {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nconst InstrumentMenu: FunctionComponent<InstrumentMenuProps> = ({\n    instruments,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n    onSelectInstrument,\n    onUseNewInstrument,\n}) => {\n    return (\n        <ul\n            className=\"instrumentSelect-dropdownMenu instrumentSelect-dropdownMenuNext dropdown-menu\"\n            data-test=\"instrument-select-menu\"\n        >\n            {instruments.map((instrument) => (\n                <li\n                    className={classNames('instrumentSelect-option dropdown-menu-item', {\n                        'instrumentSelect-option--selected':\n                            instrument.bigpayToken === selectedInstrumentId,\n                    })}\n                    key={instrument.bigpayToken}\n                >\n                    <InstrumentOption\n                        instrument={instrument}\n                        onClick={onSelectInstrument}\n                        shouldHideExpiryDate={shouldHideExpiryDate}\n                        testId=\"instrument-select-option\"\n                    />\n                </li>\n            ))}\n\n            <li className=\"instrumentSelect-option instrumentSelect-option--addNew dropdown-menu-item\">\n                <InstrumentUseNewButton\n                    onClick={onUseNewInstrument}\n                    testId=\"instrument-select-option-use-new\"\n                />\n            </li>\n        </ul>\n    );\n};\n\ninterface InstrumentSelectButtonProps {\n    instrument?: CardInstrument;\n    shouldHideExpiryDate?: boolean;\n    testId?: string;\n    onClick?(): void;\n}\n\nconst InstrumentSelectButton: FunctionComponent<InstrumentSelectButtonProps> = ({\n    instrument,\n    shouldHideExpiryDate = false,\n    testId,\n    onClick,\n}) => {\n    if (!instrument) {\n        return (\n            <InstrumentUseNewButton\n                className=\"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input\"\n                testId={testId}\n            />\n        );\n    }\n\n    return (\n        <InstrumentMenuItem\n            className=\"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input\"\n            instrument={instrument}\n            onClick={onClick}\n            shouldHideExpiryDate={shouldHideExpiryDate}\n            testId={testId}\n        />\n    );\n};\n\ninterface InstrumentOptionProps {\n    instrument: CardInstrument;\n    testId?: string;\n    shouldHideExpiryDate?: boolean;\n    onClick?(token: string): void;\n}\n\nconst InstrumentOption: FunctionComponent<InstrumentOptionProps> = ({\n    instrument,\n    shouldHideExpiryDate = false,\n    onClick = noop,\n}) => {\n    const handleClick = useCallback(() => {\n        onClick(instrument.bigpayToken);\n    }, [onClick, instrument]);\n\n    return (\n        <InstrumentMenuItem\n            instrument={instrument}\n            onClick={handleClick}\n            shouldHideExpiryDate={shouldHideExpiryDate}\n            testId=\"instrument-select-option\"\n        />\n    );\n};\n\ninterface InstrumentMenuItemProps {\n    className?: string;\n    instrument: CardInstrument;\n    testId?: string;\n    shouldHideExpiryDate?: boolean;\n    onClick?(): void;\n}\n\nconst InstrumentMenuItem: FunctionComponent<InstrumentMenuItemProps> = ({\n    className,\n    instrument,\n    testId,\n    shouldHideExpiryDate = false,\n    onClick,\n}) => {\n    const cardType = mapFromInstrumentCardType(instrument.brand);\n    const cardInfo = creditCardType.getTypeInfo(cardType);\n    const isExpired = !expirationDate({\n        month: instrument.expiryMonth,\n        year: instrument.expiryYear,\n    }).isValid;\n\n    return (\n        <button className={className} data-test={testId} onClick={onClick} type=\"button\">\n            <div\n                className={classNames('instrumentSelect-details', {\n                    'instrumentSelect-details--expired': isExpired,\n                })}\n            >\n                <CreditCardIcon cardType={cardType} />\n\n                <div className=\"instrumentSelect-card\" data-test={`${testId}-last4`}>\n                    {cardInfo ? (\n                        <TranslatedString\n                            data={{ cardTitle: cardInfo.niceType, endingIn: instrument.last4 }}\n                            id=\"payment.instrument_ending_in_text\"\n                        />\n                    ) : (\n                        <TranslatedString\n                            data={{ endingIn: instrument.last4 }}\n                            id=\"payment.instrument_default_ending_in_text\"\n                        />\n                    )}\n                </div>\n\n                {!shouldHideExpiryDate && (\n                    <div\n                        className={classNames('instrumentSelect-expiry', {\n                            'instrumentSelect-expiry--expired': isExpired,\n                        })}\n                        data-test={`${testId}-expiry`}\n                    >\n                        {isExpired ? (\n                            <TranslatedString\n                                data={{\n                                    expiryDate: `${instrument.expiryMonth}/${instrument.expiryYear}`,\n                                }}\n                                id=\"payment.instrument_expired_text\"\n                            />\n                        ) : (\n                            <TranslatedString\n                                data={{\n                                    expiryDate: `${instrument.expiryMonth}/${instrument.expiryYear}`,\n                                }}\n                                id=\"payment.instrument_expires_text\"\n                            />\n                        )}\n                    </div>\n                )}\n            </div>\n        </button>\n    );\n};\n\ninterface InstrumentUseNewButtonProps {\n    className?: string;\n    testId?: string;\n    onClick?(): void;\n}\n\nconst InstrumentUseNewButton: FunctionComponent<InstrumentUseNewButtonProps> = ({\n    className,\n    testId,\n    onClick = noop,\n}) => (\n    <button className={className} data-test={testId} onClick={onClick} type=\"button\">\n        <div className=\"instrumentSelect-details instrumentSelect-details--addNew\">\n            <CreditCardIcon />\n\n            <div className=\"instrumentSelect-card\">\n                <TranslatedString id=\"payment.instrument_add_card_action\" />\n            </div>\n        </div>\n    </button>\n);\n\nexport default InstrumentSelect;\n","import { type CardInstrument } from '@bigcommerce/checkout-sdk';\nimport { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { BasicFormField, Fieldset, Legend } from '../../ui/form';\nimport { ModalTrigger, type ModalTriggerModalProps } from '../../ui/modal';\n\nimport InstrumentSelect from './InstrumentSelect';\nimport ManageInstrumentsModal from './ManageInstrumentsModal';\n\nexport interface CardInstrumentFieldsetProps {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    validateInstrument?: React.ReactNode;\n    onDeleteInstrument?(instrumentId: string): void;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nexport enum UntrustedShippingCardVerificationType {\n    CVV = 'cvv',\n    PAN = 'pan'\n}\n\nconst CardInstrumentFieldset: FunctionComponent<CardInstrumentFieldsetProps> = ({\n    instruments,\n    onDeleteInstrument,\n    onSelectInstrument,\n    onUseNewInstrument,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n    validateInstrument = null,\n}) => {\n    const renderInput = useCallback(\n        (field: FieldProps<string>) => (\n            <InstrumentSelect\n                {...field}\n                instruments={instruments}\n                onSelectInstrument={onSelectInstrument}\n                onUseNewInstrument={onUseNewInstrument}\n                selectedInstrumentId={selectedInstrumentId}\n                shouldHideExpiryDate={shouldHideExpiryDate}\n            />\n        ),\n        [\n            instruments,\n            onSelectInstrument,\n            onUseNewInstrument,\n            selectedInstrumentId,\n            shouldHideExpiryDate,\n        ],\n    );\n\n    const renderModal = useCallback(\n        (props: ModalTriggerModalProps) => (\n            <ManageInstrumentsModal\n                instruments={instruments}\n                onDeleteInstrument={onDeleteInstrument}\n                {...props}\n            />\n        ),\n        [instruments, onDeleteInstrument],\n    );\n\n    return (\n        <Fieldset\n            additionalClassName=\"instrumentFieldset\"\n            legend={\n                <Legend hidden>\n                    <TranslatedString id=\"payment.instrument_text\" />\n                </Legend>\n            }\n        >\n            <ModalTrigger modal={renderModal}>\n                {({ onClick }) => (\n                    <button className=\"instrumentModal-trigger\" onClick={onClick} type=\"button\">\n                        <TranslatedString id=\"payment.instrument_manage_button\" />\n                    </button>\n                )}\n            </ModalTrigger>\n\n            <BasicFormField name=\"instrumentId\" render={renderInput} />\n\n            <div style={{ display: selectedInstrumentId ? undefined : 'none' }}>\n                {validateInstrument}\n            </div>\n        </Fieldset>\n    );\n};\n\nexport default memo(CardInstrumentFieldset);\n","import { type LineItemMap, type PaymentInstrument, type PaymentMethod } from '@bigcommerce/checkout-sdk';\n\nimport { UntrustedShippingCardVerificationType } from './CardInstrumentFieldset';\n\nexport const PROVIDERS_WITHOUT_CARD_CODE = ['bluesnapdirect'];\n\nexport interface IsInstrumentCardCodeRequiredState {\n    instrument: PaymentInstrument;\n    lineItems: LineItemMap;\n    paymentMethod: PaymentMethod;\n}\n\nexport default function isInstrumentCardCodeRequired({\n    instrument,\n    lineItems,\n    paymentMethod,\n}: IsInstrumentCardCodeRequiredState): boolean {\n    if (PROVIDERS_WITHOUT_CARD_CODE.includes(instrument.provider)) {\n        return false;\n    }\n\n    // If there's a digital item in the cart, always show CVV field\n    if (lineItems.digitalItems.length > 0 || lineItems.giftCertificates.length > 0) {\n        return true;\n    }\n\n    // If the shipping address is trusted, show CVV field based on the merchant's configuration\n    if (instrument.trustedShippingAddress) {\n        return !!paymentMethod.config.isVaultingCvvEnabled;\n    }\n\n    // If the shipping address is untrusted, card verficiation mode has set with cvv, card code is required\n    if ('untrustedShippingCardVerificationMode' in instrument && instrument.untrustedShippingCardVerificationMode === UntrustedShippingCardVerificationType.CVV) {\n        return true;\n    }\n\n    // Otherwise, if the shipping address is untrusted, show CVV field if the\n    // merchant either requires it for regular card or stored card payments.\n    return !!(paymentMethod.config.isVaultingCvvEnabled || paymentMethod.config.cardCode);\n}\n","import { type CheckoutSelectors, type Instrument, type PaymentMethod } from '@bigcommerce/checkout-sdk';\nimport { createSelector } from 'reselect';\n\nimport isInstrumentCardCodeRequired from './isInstrumentCardCodeRequired';\n\nconst isInstrumentCardCodeRequiredSelector = createSelector(\n    ({ data }: CheckoutSelectors) => {\n        const cart = data.getCart();\n\n        return cart && cart.lineItems;\n    },\n    (lineItems) => (instrument: Instrument, method: PaymentMethod) => {\n        if (!lineItems) {\n            return false;\n        }\n\n        return isInstrumentCardCodeRequired({\n            instrument,\n            lineItems,\n            paymentMethod: method,\n        });\n    },\n);\n\nexport default isInstrumentCardCodeRequiredSelector;\n","import { type CheckoutSelectors, type Instrument } from '@bigcommerce/checkout-sdk';\nimport { createSelector } from 'reselect';\n\nimport isInstrumentCardNumberRequired from './isInstrumentCardNumberRequired';\n\nconst isInstrumentCardNumberRequiredSelector = createSelector(\n    ({ data }: CheckoutSelectors) => {\n        const cart = data.getCart();\n\n        return cart && cart.lineItems;\n    },\n    (lineItems) => (instrument: Instrument) => {\n        if (!lineItems) {\n            return false;\n        }\n\n        return isInstrumentCardNumberRequired({\n            lineItems,\n            instrument,\n        });\n    },\n);\n\nexport default isInstrumentCardNumberRequiredSelector;\n","import { type Instrument, type LineItemMap } from '@bigcommerce/checkout-sdk';\n\nimport { UntrustedShippingCardVerificationType } from './CardInstrumentFieldset';\n\nexport interface IsInstrumentCardNumberRequiredState {\n    lineItems: LineItemMap;\n    instrument: Instrument;\n}\n\nexport default function isInstrumentCardNumberRequired({\n    lineItems,\n    instrument,\n}: IsInstrumentCardNumberRequiredState): boolean {\n    if (lineItems.physicalItems.length === 0) {\n        return false;\n    }\n\n    if (instrument.trustedShippingAddress) {\n        return false;\n    }  \n    \n    return !(instrument.untrustedShippingCardVerificationMode === UntrustedShippingCardVerificationType.CVV);\n}\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { object, type ObjectSchema, string } from 'yup';\n\nexport interface HostedCreditCardValidationSchemaOptions {\n    language: LanguageService;\n}\n\nexport interface HostedCreditCardValidationSchemaShape {\n    hostedForm: {\n        errors: {\n            cardCode: string;\n            cardExpiry: string;\n            cardName: string;\n            cardNumber: string;\n        };\n    };\n}\n\nexport default memoize(function getHostedCreditCardValidationSchema({\n    language,\n}: HostedCreditCardValidationSchemaOptions): ObjectSchema<HostedCreditCardValidationSchemaShape> {\n    return object().shape<HostedCreditCardValidationSchemaShape>({\n        hostedForm: object().required().shape<HostedCreditCardValidationSchemaShape[\"hostedForm\"]>({\n            errors: object().required().shape<HostedCreditCardValidationSchemaShape[\"hostedForm\"][\"errors\"]>({\n                cardCode: string()\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_invalid_error'),\n                        test: (value) => value !== 'invalid_card_code',\n                    }),\n\n                cardExpiry: string()\n                    .test({\n                        message: language.translate(\n                            'payment.credit_card_expiration_required_error',\n                        ),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_expiration_invalid_error'),\n                        test: (value) => value !== 'invalid_card_expiry',\n                    }),\n\n                cardName: string()\n                    .test({\n                        message: language.translate('payment.credit_card_name_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_name_invalid_error'),\n                        test: (value) => value !== 'invalid_card_name',\n                    }),\n\n                cardNumber: string()\n                    .test({\n                        message: language.translate('payment.credit_card_number_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_number_invalid_error'),\n                        test: (value) => value !== 'invalid_card_number',\n                    }),\n            }),\n        }),\n    });\n});\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { object, type ObjectSchema, string } from 'yup';\n\nexport interface HostedInstrumentValidationSchemaOptions {\n    language: LanguageService;\n    isCardExpiryRequired?: boolean;\n}\n\nexport interface HostedInstrumentValidationSchemaShape {\n    hostedForm: {\n        errors: {\n            cardCodeVerification: string;\n            cardNumberVerification: string;\n        };\n    };\n    instrumentId: string;\n}\n\nexport default memoize(function getHostedInstrumentValidationSchema({\n    language,\n    isCardExpiryRequired,\n}: HostedInstrumentValidationSchemaOptions): ObjectSchema<HostedInstrumentValidationSchemaShape> {\n    return object().shape<HostedInstrumentValidationSchemaShape>({\n        instrumentId: string().required(),\n\n        hostedForm: object().required().shape<HostedInstrumentValidationSchemaShape[\"hostedForm\"]>({\n            errors: object().required().shape<HostedInstrumentValidationSchemaShape[\"hostedForm\"][\"errors\"]>({\n                cardCodeVerification: string()\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_invalid_error'),\n                        test: (value) => value !== 'invalid_card_code',\n                    }),\n\n                cardNumberVerification: string()\n                    .test({\n                        message: language.translate('payment.credit_card_number_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_number_invalid_error'),\n                        test: (value) => value !== 'invalid_card_number',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_number_mismatch_error'),\n                        test: (value) => value !== 'mismatched_card_number',\n                    }),\n\n            ...(isCardExpiryRequired ? {\n                cardExpiryVerification: string()\n                    .test({\n                        message: language.translate(\n                            'payment.credit_card_expiration_required_error',\n                        ),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_expiration_invalid_error'),\n                        test: (value) => value !== 'invalid_card_expiry',\n                    }),\n            } : {})\n            }),\n        }),\n    });\n});\n","import classNames from 'classnames';\nimport React, { type FunctionComponent, type HTMLAttributes } from 'react';\n\nexport interface TextInputIframeContainerProps extends HTMLAttributes<HTMLDivElement> {\n    additionalClassName?: string;\n    appearFocused?: boolean;\n    testId?: string;\n}\n\nconst TextInputIframeContainer: FunctionComponent<TextInputIframeContainerProps> = ({\n    additionalClassName,\n    appearFocused,\n    testId,\n    ...props\n}) => (\n    <div\n        {...props}\n        className={classNames(\n            'form-input',\n            'optimizedCheckout-form-input',\n            { 'form-input--focus': appearFocused },\n            { 'optimizedCheckout-form-input--focus': appearFocused },\n            additionalClassName,\n        )}\n        data-test={testId}\n    />\n);\n\nexport default TextInputIframeContainer;\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconLock: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconLock);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconHelp: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconHelp);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconCardCodeVisa: FunctionComponent = () => (\n    <svg height=\"54\" viewBox=\"0 0 88 54\" width=\"88\" xmlns=\"http://www.w3.org/2000/svg\">\n        <title>CVV visa, mc, disc</title>\n        <g fill=\"none\" fillRule=\"evenodd\">\n            <rect fill=\"#DEDEDE\" height=\"54\" rx=\"3\" width=\"88\" />\n            <path d=\"M0 5h88v12H0z\" fill=\"#838383\" />\n            <path d=\"M3 23h82v10H3z\" fill=\"#FFF\" />\n            <path\n                d=\"M69.81 29.053c.015.297.13.502.343.616.11.058.233.088.37.088.258 0 .477-.107.66-.32.18-.215.31-.65.384-1.306-.12.19-.267.322-.444.4-.176.076-.366.114-.57.114-.412 0-.74-.13-.98-.386-.24-.257-.36-.588-.36-.993 0-.388.12-.73.357-1.025.237-.295.587-.443 1.05-.443.623 0 1.054.28 1.29.842.133.31.2.696.2 1.16 0 .525-.08.99-.238 1.394-.26.674-.703 1.01-1.327 1.01-.42 0-.737-.11-.954-.328-.217-.22-.325-.494-.325-.825h.544zm1.4-1.09c.176-.14.265-.387.265-.737 0-.315-.08-.55-.238-.705-.16-.153-.36-.23-.606-.23-.262 0-.47.088-.625.264-.155.177-.232.412-.232.707 0 .28.068.502.203.667.136.164.352.246.65.246.213 0 .408-.07.584-.21zm3.414-.563c.133-.132.2-.29.2-.474 0-.16-.064-.306-.19-.44-.13-.133-.323-.2-.585-.2-.26 0-.447.067-.563.2-.115.134-.173.29-.173.47 0 .202.075.36.224.473.15.112.326.17.53.17.237 0 .422-.067.556-.2zm.097 2.118c.165-.135.247-.336.247-.603 0-.277-.084-.487-.254-.63-.17-.144-.386-.216-.652-.216-.256 0-.466.072-.628.22-.163.145-.244.348-.244.607 0 .223.074.416.223.58.15.16.38.243.69.243.25 0 .456-.068.62-.202zm-1.735-1.937c-.158-.158-.236-.365-.236-.62 0-.32.114-.594.345-.823.232-.23.56-.344.984-.344.41 0 .732.108.965.325.233.216.35.47.35.758 0 .267-.068.483-.203.65-.076.092-.194.184-.353.274.176.08.316.175.418.28.19.2.284.46.284.778 0 .377-.127.697-.38.96-.253.26-.61.392-1.074.392-.416 0-.77-.113-1.057-.34-.287-.226-.43-.554-.43-.985 0-.253.06-.472.184-.656.124-.186.307-.327.55-.424-.15-.064-.265-.14-.35-.225zm5.614-1.42c.188.248.282.503.282.766h-.532c-.032-.17-.083-.302-.153-.397-.13-.18-.326-.27-.59-.27-.3 0-.54.14-.717.417-.177.278-.276.676-.296 1.194.124-.18.28-.316.467-.405.172-.08.364-.12.575-.12.36 0 .672.115.94.344.266.228.4.57.4 1.025 0 .388-.127.733-.38 1.033-.253.3-.614.45-1.083.45-.4 0-.746-.152-1.037-.456-.29-.304-.437-.816-.437-1.536 0-.532.065-.983.194-1.354.25-.71.705-1.065 1.367-1.065.478 0 .81.124 1 .372zm-.404 3.274c.14-.19.21-.415.21-.674 0-.22-.062-.43-.188-.627-.126-.198-.354-.297-.685-.297-.23 0-.434.076-.608.23-.175.153-.262.385-.262.694 0 .27.08.498.238.683.16.184.38.277.66.277.283 0 .495-.096.636-.286z\"\n                fill=\"#636363\"\n            />\n            <rect height=\"18\" rx=\"40\" stroke=\"#ED6A6A\" strokeWidth=\"2\" width=\"18\" x=\"65\" y=\"19\" />\n        </g>\n    </svg>\n);\n\nexport default withIconContainer(IconCardCodeVisa);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconCardCodeAmex: FunctionComponent = () => (\n    <svg height=\"54\" viewBox=\"0 0 88 54\" width=\"88\" xmlns=\"http://www.w3.org/2000/svg\">\n        <title>CVV amex</title>\n        <g fill=\"none\" fillRule=\"evenodd\">\n            <rect fill=\"#DEDEDE\" height=\"54\" rx=\"3\" width=\"88\" />\n            <text\n                fill=\"#979BA1\"\n                fontFamily=\"Avenir Next\"\n                fontSize=\"6\"\n                fontWeight=\"420\"\n                letterSpacing=\".2\"\n            >\n                <tspan x=\"11\" y=\"35\">\n                    3712 567890 374\n                </tspan>\n                <tspan x=\"70.21\" y=\"35\">\n                    5\n                </tspan>\n            </text>\n            <path\n                d=\"M69.182 26.767h-.55v-3.35l-.762.635-.324-.38 1.142-.926h.494v4.02zm4.19 0H70.75v-.528l1.6-1.59c.122-.126.226-.257.313-.393s.13-.29.13-.46c0-.106-.018-.202-.056-.287-.038-.085-.09-.158-.153-.22-.065-.06-.14-.106-.228-.138-.087-.032-.18-.048-.278-.048-.204 0-.373.065-.505.196-.133.13-.216.298-.25.503l-.54-.09c.023-.153.07-.294.145-.424.074-.132.168-.246.28-.342.115-.097.246-.17.396-.224.15-.053.31-.08.48-.08.166 0 .326.025.48.074.153.05.288.12.406.216.117.094.21.214.28.357.07.145.106.31.106.496 0 .128-.017.248-.05.357-.035.11-.082.214-.14.313-.06.098-.128.192-.208.28-.08.09-.162.178-.25.265l-1.306 1.273h1.97v.494zm1.625-2.328h.176c.114 0 .225-.012.333-.033.107-.02.203-.056.286-.107.084-.052.15-.12.202-.208.05-.087.077-.195.077-.323 0-.104-.018-.196-.056-.277-.038-.08-.09-.15-.156-.207-.067-.057-.142-.102-.227-.134-.085-.032-.175-.048-.27-.048-.17 0-.314.044-.434.13-.12.088-.21.21-.27.364l-.5-.176c.1-.242.257-.433.475-.57.22-.14.47-.208.753-.208.167 0 .325.024.475.07.15.048.28.117.394.208.114.09.204.205.27.34.066.137.1.294.1.472 0 .114-.018.22-.054.318-.036.1-.086.188-.148.267-.063.08-.137.147-.224.204-.087.057-.182.098-.284.125v.01c.117.023.226.063.326.12.1.056.187.127.26.212.07.086.127.183.17.293.04.11.06.23.06.358 0 .2-.036.377-.112.53-.076.154-.176.282-.3.384-.126.102-.27.18-.433.233-.163.053-.33.08-.5.08-.318 0-.598-.073-.84-.216-.242-.144-.418-.368-.528-.67l.51-.17c.06.173.165.315.31.425.146.11.325.164.537.164.102 0 .202-.016.298-.05.097-.03.183-.08.26-.143.074-.064.135-.143.18-.238.046-.095.07-.206.07-.335 0-.14-.032-.257-.092-.352-.06-.095-.14-.17-.236-.23-.097-.06-.205-.1-.327-.125-.12-.025-.24-.037-.357-.037h-.17v-.454zm4.73.953h.58v.47h-.58v.904h-.533v-.903h-1.85v-.5l1.708-2.618h.676v2.647zm-.533-2.016h-.01l-1.273 2.016h1.284v-2.016z\"\n                fill=\"#636363\"\n                opacity=\".9\"\n            />\n            <rect height=\"18\" rx=\"40\" stroke=\"#ED6A6A\" strokeWidth=\"2\" width=\"18\" x=\"65\" y=\"16\" />\n        </g>\n    </svg>\n);\n\nexport default withIconContainer(IconCardCodeAmex);\n","import React, { type FunctionComponent } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { IconCardCodeAmex, IconCardCodeVisa, IconSize } from '../../ui/icon';\n\nimport './CreditCardCodeTooltip.scss';\n\nconst CreditCardCodeTooltip: FunctionComponent = () => (\n    <div className=\"dropdown-menu dropdown-menu--content dropdown-menu--card-code\">\n        <div className=\"form-ccFields-cvvExample\">\n            <div className=\"form-ccFields-cvvExampleDescription\">\n                <p>\n                    <TranslatedString id=\"payment.credit_card_cvv_help_text\" />\n                </p>\n            </div>\n\n            <div className=\"form-ccFields-cvvExampleFigures\">\n                <figure>\n                    <IconCardCodeVisa size={IconSize.Large} />\n                </figure>\n\n                <figure>\n                    <IconCardCodeAmex size={IconSize.Large} />\n                </figure>\n            </div>\n        </div>\n    </div>\n);\n\nexport default CreditCardCodeTooltip;\n","import React, { type FunctionComponent, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\nimport { IconHelp, IconLock } from '../../ui/icon';\nimport { TooltipTrigger } from '../../ui/tooltip';\nimport { CreditCardCodeTooltip } from '../creditCard';\n\nexport interface HostedCreditCardCodeFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardCodeField: FunctionComponent<HostedCreditCardCodeFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => (\n            <>\n                <TextInputIframeContainer\n                    additionalClassName=\"has-icon\"\n                    appearFocused={appearFocused}\n                    id={id}\n                />\n\n                <IconLock />\n            </>\n        ),\n        [id, appearFocused],\n    );\n\n    const labelContent = useMemo(\n        () => (\n            <>\n                <TranslatedString id=\"payment.credit_card_cvv_label\" />\n\n                <TooltipTrigger placement=\"top-start\" tooltip={<CreditCardCodeTooltip />}>\n                    <span className=\"has-tip\">\n                        <IconHelp />\n                    </span>\n                </TooltipTrigger>\n            </>\n        ),\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-ccFields-field--ccCvv\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardCodeField;\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\n\nexport interface HostedCreditCardExpiryFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardExpiryField: FunctionComponent<HostedCreditCardExpiryFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => <TextInputIframeContainer appearFocused={appearFocused} id={id} />,\n        [id, appearFocused],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccExpiry\"\n            input={renderInput}\n            labelContent={<TranslatedString id=\"payment.credit_card_expiration_label\" />}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardExpiryField;\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\n\nexport interface HostedCreditCardNameFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardNameField: FunctionComponent<HostedCreditCardNameFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => <TextInputIframeContainer appearFocused={appearFocused} id={id} />,\n        [id, appearFocused],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccName\"\n            input={renderInput}\n            labelContent={<TranslatedString id=\"payment.credit_card_name_label\" />}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardNameField;\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\nimport { IconLock } from '../../ui/icon';\n\nexport interface HostedCreditCardNumberFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardNumberField: FunctionComponent<HostedCreditCardNumberFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => (\n            <>\n                <TextInputIframeContainer\n                    additionalClassName=\"has-icon\"\n                    appearFocused={appearFocused}\n                    id={id}\n                />\n\n                <IconLock />\n            </>\n        ),\n        [id, appearFocused],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccNumber\"\n            input={renderInput}\n            labelContent={<TranslatedString id=\"payment.credit_card_number_label\" />}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardNumberField;\n","import React, { type FunctionComponent, type ReactNode } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { Fieldset, Legend } from '../../ui/form';\n\nimport HostedCreditCardCodeField from './HostedCreditCardCodeField';\nimport HostedCreditCardExpiryField from './HostedCreditCardExpiryField';\nimport HostedCreditCardNameField from './HostedCreditCardNameField';\nimport HostedCreditCardNumberField from './HostedCreditCardNumberField';\n\nexport interface HostedCreditCardFieldsetProps {\n    additionalFields?: ReactNode;\n    cardCodeId?: string;\n    cardExpiryId: string;\n    cardNameId?: string;\n    cardNumberId: string;\n    focusedFieldType?: string;\n}\n\nconst HostedCreditCardFieldset: FunctionComponent<HostedCreditCardFieldsetProps> = ({\n    additionalFields,\n    cardCodeId,\n    cardExpiryId,\n    cardNameId,\n    cardNumberId,\n    focusedFieldType,\n}) => (\n    <Fieldset\n        legend={\n            <Legend hidden>\n                <TranslatedString id=\"payment.credit_card_text\" />\n            </Legend>\n        }\n    >\n        <div className=\"form-ccFields\">\n            <HostedCreditCardNumberField\n                appearFocused={focusedFieldType === 'cardNumber'}\n                id={cardNumberId}\n                name=\"hostedForm.errors.cardNumber\"\n            />\n\n            <HostedCreditCardExpiryField\n                appearFocused={focusedFieldType === 'cardExpiry'}\n                id={cardExpiryId}\n                name=\"hostedForm.errors.cardExpiry\"\n            />\n\n            {cardNameId && (\n                <HostedCreditCardNameField\n                    appearFocused={focusedFieldType === 'cardName'}\n                    id={cardNameId}\n                    name=\"hostedForm.errors.cardName\"\n                />\n            )}\n\n            {cardCodeId && (\n                <HostedCreditCardCodeField\n                    appearFocused={focusedFieldType === 'cardCode'}\n                    id={cardCodeId}\n                    name=\"hostedForm.errors.cardCode\"\n                />\n            )}\n\n            {additionalFields}\n        </div>\n    </Fieldset>\n);\n\nexport default HostedCreditCardFieldset;\n","import React, { type FunctionComponent } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport HostedCreditCardCodeField from './HostedCreditCardCodeField';\nimport HostedCreditCardExpiryField from \"./HostedCreditCardExpiryField\";\nimport HostedCreditCardNumberField from './HostedCreditCardNumberField';\n\nexport interface HostedCreditCardValidationProps {\n    cardCodeId?: string;\n    cardNumberId?: string;\n    cardExpiryId?: string;\n    focusedFieldType?: string;\n}\n\nconst HostedCreditCardValidation: FunctionComponent<HostedCreditCardValidationProps> = ({\n    cardCodeId,\n    cardNumberId,\n    cardExpiryId,\n    focusedFieldType,\n}) => (\n    <>\n        {cardNumberId && (\n            <p>\n                <strong>\n                    <TranslatedString id=\"payment.instrument_trusted_shipping_address_title_text\" />\n                </strong>\n\n                <br />\n\n                <TranslatedString id=\"payment.instrument_trusted_shipping_address_text\" />\n            </p>\n        )}\n\n        <div className=\"form-ccFields\">\n            {cardNumberId && (\n                <HostedCreditCardNumberField\n                    appearFocused={focusedFieldType === 'cardNumber'}\n                    id={cardNumberId}\n                    name=\"hostedForm.errors.cardNumberVerification\"\n                />\n            )}\n\n            {cardCodeId && (\n                <HostedCreditCardCodeField\n                    appearFocused={focusedFieldType === 'cardCode'}\n                    id={cardCodeId}\n                    name=\"hostedForm.errors.cardCodeVerification\"\n                />\n            )}\n\n            {cardExpiryId && (\n                <HostedCreditCardExpiryField\n                    appearFocused={focusedFieldType === 'cardExpiry'}\n                    id={cardExpiryId}\n                    name=\"hostedForm.errors.cardExpiryVerification\"\n                />\n            )}\n        </div>\n    </>\n);\n\nexport default HostedCreditCardValidation;\n","import {\n    type CardInstrument,\n    type Instrument,\n    type LegacyHostedFormOptions,\n    type PaymentMethod,\n} from '@bigcommerce/checkout-sdk';\nimport { compact, forIn } from 'lodash';\nimport React, { type ComponentType, type FunctionComponent, type ReactNode, useCallback, useState } from 'react';\nimport { type ObjectSchema } from 'yup';\n\nimport { type MapToPropsFactory } from '@bigcommerce/checkout/legacy-hoc';\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { type CheckoutContextProps, type PaymentFormValues } from '@bigcommerce/checkout/payment-integration-api';\n\nimport { withCheckout } from '../../checkout';\nimport { connectFormik, type ConnectFormikProps } from '../../common/form';\nimport { withForm, type WithFormProps } from '../../ui/form';\nimport {\n    CreditCardCustomerCodeField,\n    CreditCardInputStylesType,\n    getCreditCardInputStyles,\n} from '../creditCard';\nimport {\n    isInstrumentCardCodeRequiredSelector,\n    isInstrumentCardNumberRequiredSelector,\n    isInstrumentFeatureAvailable,\n} from '../storedInstrument';\n\nimport getHostedCreditCardValidationSchema, {\n    type HostedCreditCardValidationSchemaShape,\n} from './getHostedCreditCardValidationSchema';\nimport getHostedInstrumentValidationSchema, {\n    type HostedInstrumentValidationSchemaShape,\n} from './getHostedInstrumentValidationSchema';\nimport HostedCreditCardFieldset from './HostedCreditCardFieldset';\nimport HostedCreditCardValidation from './HostedCreditCardValidation';\n\nexport interface WithHostedCreditCardFieldsetProps {\n    isUsingMultiShipping?: boolean;\n    method: PaymentMethod;\n}\n\nexport interface WithInjectedHostedCreditCardFieldsetProps {\n    hostedFieldset: ReactNode;\n    hostedStoredCardValidationSchema: ObjectSchema<HostedInstrumentValidationSchemaShape>;\n    hostedValidationSchema: ObjectSchema<HostedCreditCardValidationSchemaShape>;\n    getHostedFormOptions(selectedInstrument?: CardInstrument): Promise<LegacyHostedFormOptions>;\n    getHostedStoredCardValidationFieldset(selectedInstrument?: CardInstrument): ReactNode;\n}\n\ninterface WithCheckoutContextProps {\n    isCardCodeRequired: boolean;\n    isInstrumentFeatureAvailable: boolean;\n    isInstrumentCardCodeRequired(instrument: Instrument, method: PaymentMethod): boolean;\n    isInstrumentCardNumberRequired(instrument: Instrument): boolean;\n}\n\nexport default function withHostedCreditCardFieldset<\n    TProps extends WithHostedCreditCardFieldsetProps,\n>(\n    OriginalComponent: ComponentType<TProps & Partial<WithInjectedHostedCreditCardFieldsetProps>>,\n): ComponentType<Omit<TProps, keyof WithInjectedHostedCreditCardFieldsetProps>> {\n    const Component: FunctionComponent<\n        WithHostedCreditCardFieldsetProps &\n            WithCheckoutContextProps &\n            WithLanguageProps &\n            WithFormProps &\n            ConnectFormikProps<PaymentFormValues>\n    > = ({\n        formik: { setFieldValue, setFieldTouched, submitForm },\n        isCardCodeRequired,\n        isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredProp,\n        isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredProp,\n        isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n        isSubmitted,\n        language,\n        method,\n        setSubmitted,\n        ...rest\n    }) => {\n        const [focusedFieldType, setFocusedFieldType] = useState<string>();\n\n        const getHostedFieldId: (name: string) => string = useCallback(\n            (name) => {\n                return `${compact([method.gateway, method.id]).join('-')}-${name}`;\n            },\n            [method],\n        );\n\n        const getHostedFormOptions: (\n            selectedInstrument?: CardInstrument,\n        ) => Promise<LegacyHostedFormOptions> = useCallback(\n            async (selectedInstrument) => {\n                const styleProps = ['color', 'fontFamily', 'fontSize', 'fontWeight'];\n                const isInstrumentCardNumberRequired = selectedInstrument\n                    ? isInstrumentCardNumberRequiredProp(selectedInstrument)\n                    : false;\n                const isInstrumentCardCodeRequired = selectedInstrument\n                    ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n                    : false;\n                const styleContainerId = selectedInstrument\n                    ? isInstrumentCardCodeRequired\n                        ? getHostedFieldId('ccCvv')\n                        : undefined\n                    : getHostedFieldId('ccNumber');\n\n                return {\n                    fields: selectedInstrument\n                        ? {\n                              cardCodeVerification:\n                                  isInstrumentCardCodeRequired && selectedInstrument\n                                      ? {\n                                            accessibilityLabel: language.translate(\n                                                'payment.credit_card_cvv_label',\n                                            ),\n                                            containerId: getHostedFieldId('ccCvv'),\n                                            instrumentId: selectedInstrument.bigpayToken,\n                                        }\n                                      : undefined,\n                              cardNumberVerification:\n                                  isInstrumentCardNumberRequired && selectedInstrument\n                                      ? {\n                                            accessibilityLabel: language.translate(\n                                                'payment.credit_card_number_label',\n                                            ),\n                                            containerId: getHostedFieldId('ccNumber'),\n                                            instrumentId: selectedInstrument.bigpayToken,\n                                        }\n                                      : undefined,\n                          }\n                        : {\n                              cardCode: isCardCodeRequired\n                                  ? {\n                                        accessibilityLabel: language.translate(\n                                            'payment.credit_card_cvv_label',\n                                        ),\n                                        containerId: getHostedFieldId('ccCvv'),\n                                    }\n                                  : undefined,\n                              cardExpiry: {\n                                  accessibilityLabel: language.translate(\n                                      'payment.credit_card_expiration_label',\n                                  ),\n                                  containerId: getHostedFieldId('ccExpiry'),\n                                  placeholder: language.translate(\n                                      'payment.credit_card_expiration_placeholder_text',\n                                  ),\n                              },\n                              cardName: {\n                                  accessibilityLabel: language.translate(\n                                      'payment.credit_card_name_label',\n                                  ),\n                                  containerId: getHostedFieldId('ccName'),\n                              },\n                              cardNumber: {\n                                  accessibilityLabel: language.translate(\n                                      'payment.credit_card_number_label',\n                                  ),\n                                  containerId: getHostedFieldId('ccNumber'),\n                              },\n                          },\n                    styles: styleContainerId\n                        ? {\n                              default: await getCreditCardInputStyles(styleContainerId, styleProps),\n                              error: await getCreditCardInputStyles(\n                                  styleContainerId,\n                                  styleProps,\n                                  CreditCardInputStylesType.Error,\n                              ),\n                              focus: await getCreditCardInputStyles(\n                                  styleContainerId,\n                                  styleProps,\n                                  CreditCardInputStylesType.Focus,\n                              ),\n                          }\n                        : {},\n                    onBlur: ({ fieldType }) => {\n                        if (focusedFieldType === fieldType) {\n                            setFocusedFieldType(undefined);\n                        }\n                    },\n                    onCardTypeChange: ({ cardType }) => {\n                        setFieldValue('hostedForm.cardType', cardType);\n                    },\n                    onEnter: () => {\n                        setSubmitted(true);\n                        submitForm();\n                    },\n                    onFocus: ({ fieldType }) => {\n                        setFocusedFieldType(fieldType);\n                    },\n                    onValidate: ({ errors = {} }) => {\n                        forIn(errors, (fieldErrors = [], fieldType) => {\n                            const errorKey = `hostedForm.errors.${fieldType}`;\n\n                            setFieldValue(errorKey, fieldErrors[0]?.type ?? '');\n\n                            if (fieldErrors[0]) {\n                                setFieldTouched(errorKey);\n                            }\n                        });\n                    },\n                };\n            },\n            [\n                focusedFieldType,\n                getHostedFieldId,\n                isCardCodeRequired,\n                isInstrumentCardCodeRequiredProp,\n                isInstrumentCardNumberRequiredProp,\n                language,\n                method,\n                setFieldValue,\n                setFieldTouched,\n                setFocusedFieldType,\n                setSubmitted,\n                submitForm,\n            ],\n        );\n\n        const getHostedStoredCardValidationFieldset: (\n            selectedInstrument: CardInstrument,\n        ) => ReactNode = useCallback(\n            (selectedInstrument) => {\n                const isInstrumentCardNumberRequired = selectedInstrument\n                    ? isInstrumentCardNumberRequiredProp(selectedInstrument)\n                    : false;\n                const isInstrumentCardCodeRequired = selectedInstrument\n                    ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n                    : false;\n\n                return (\n                    <HostedCreditCardValidation\n                        cardCodeId={\n                            isInstrumentCardCodeRequired ? getHostedFieldId('ccCvv') : undefined\n                        }\n                        cardNumberId={\n                            isInstrumentCardNumberRequired\n                                ? getHostedFieldId('ccNumber')\n                                : undefined\n                        }\n                        focusedFieldType={focusedFieldType}\n                    />\n                );\n            },\n            [\n                focusedFieldType,\n                getHostedFieldId,\n                isInstrumentCardCodeRequiredProp,\n                isInstrumentCardNumberRequiredProp,\n                method,\n            ],\n        );\n\n        if (!method.config.isHostedFormEnabled) {\n            return <OriginalComponent {...(rest as TProps)} method={method} />;\n        }\n\n        return (\n            <OriginalComponent\n                {...(rest as TProps)}\n                getHostedFormOptions={getHostedFormOptions}\n                getHostedStoredCardValidationFieldset={getHostedStoredCardValidationFieldset}\n                hostedFieldset={\n                    <HostedCreditCardFieldset\n                        additionalFields={\n                            method.config.requireCustomerCode && (\n                                <CreditCardCustomerCodeField name=\"ccCustomerCode\" />\n                            )\n                        }\n                        cardCodeId={isCardCodeRequired ? getHostedFieldId('ccCvv') : undefined}\n                        cardExpiryId={getHostedFieldId('ccExpiry')}\n                        cardNameId={getHostedFieldId('ccName')}\n                        cardNumberId={getHostedFieldId('ccNumber')}\n                        focusedFieldType={focusedFieldType}\n                    />\n                }\n                hostedStoredCardValidationSchema={getHostedInstrumentValidationSchema({ language })}\n                hostedValidationSchema={getHostedCreditCardValidationSchema({ language })}\n                method={method}\n            />\n        );\n    };\n\n    return connectFormik(\n        withForm(withLanguage(withCheckout(mapFromCheckoutProps)(Component))),\n    ) as ComponentType<Omit<TProps, keyof WithInjectedHostedCreditCardFieldsetProps>>;\n}\n\nconst mapFromCheckoutProps: MapToPropsFactory<\n    CheckoutContextProps,\n    WithCheckoutContextProps,\n    WithHostedCreditCardFieldsetProps & ConnectFormikProps<PaymentFormValues>\n> = () => {\n    return ({ checkoutState }, { method }) => {\n        const {\n            data: { getConfig, getCustomer },\n        } = checkoutState;\n\n        const config = getConfig();\n        const customer = getCustomer();\n\n        if (!config || !customer) {\n            return null;\n        }\n\n        const isInstrumentFeatureAvailableProp = isInstrumentFeatureAvailable({\n            config,\n            customer,\n            paymentMethod: method,\n        });\n\n        return {\n            method,\n            isCardCodeRequired: method.config.cardCode || method.config.cardCode === null,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredSelector(checkoutState),\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredSelector(checkoutState),\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n        };\n    };\n};\n","import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\nimport { IconHelp, IconLock } from '../../ui/icon';\nimport { TooltipTrigger } from '../../ui/tooltip';\n\nimport CreditCardCodeTooltip from './CreditCardCodeTooltip';\n\nexport interface CreditCardCodeFieldProps {\n    name: string;\n}\n\nconst CreditCardCodeField: FunctionComponent<CreditCardCodeFieldProps> = ({ name }) => {\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => (\n            <>\n                <TextInput\n                    {...field}\n                    additionalClassName=\"has-icon\"\n                    autoComplete=\"cc-csc\"\n                    id={field.name}\n                    type=\"tel\"\n                />\n\n                <IconLock />\n            </>\n        ),\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => (\n            <>\n                <TranslatedString id=\"payment.credit_card_cvv_label\" />\n\n                <TooltipTrigger placement=\"top-start\" tooltip={<CreditCardCodeTooltip />}>\n                    <span className=\"has-tip\">\n                        <IconHelp />\n                    </span>\n                </TooltipTrigger>\n            </>\n        ),\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-ccFields-field--ccCvv\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default memo(CreditCardCodeField);\n","import { memoizeOne } from '@bigcommerce/memoize';\nimport { type FieldProps } from 'formik';\nimport React, { type ChangeEvent, type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString, withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\n\nimport formatCreditCardExpiryDate from './formatCreditCardExpiryDate';\n\nexport interface CreditCardExpiryFieldProps {\n    name: string;\n}\n\nconst CreditCardExpiryField: FunctionComponent<CreditCardExpiryFieldProps & WithLanguageProps> = ({\n    language,\n    name,\n}) => {\n    const handleChange = useCallback(\n        memoizeOne((field: FieldProps['field'], form: FieldProps['form']) => {\n            return (event: ChangeEvent<any>) => {\n                form.setFieldValue(field.name, formatCreditCardExpiryDate(event.target.value));\n            };\n        }),\n        [],\n    );\n\n    const renderInput = useCallback(\n        ({ field, form }: FieldProps) => (\n            <TextInput\n                {...field}\n                autoComplete=\"cc-exp\"\n                id={field.name}\n                onChange={handleChange(field, form)}\n                placeholder={language.translate('payment.credit_card_expiration_placeholder_text')}\n                type=\"tel\"\n            />\n        ),\n        [handleChange, language],\n    );\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"payment.credit_card_expiration_label\" />,\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccExpiry\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default memo(withLanguage(CreditCardExpiryField));\n","export default function formatCreditCardExpiryDate(value: string): string {\n    const separator = '/';\n    const [month = '', year = ''] = value.split(new RegExp(`\\\\s*${separator}\\\\s*`));\n    const trimmedMonth = month.slice(0, 2);\n    const trimmedYear =\n        year.length === 4 ? year.slice(-2) : year ? year.slice(0, 2) : month.slice(2);\n\n    // i.e.: '1'\n    if (value.length < 2) {\n        return month;\n    }\n\n    // ie.: '10 /' (without trailing space)\n    if (value.length > 3 && !trimmedYear) {\n        return trimmedMonth;\n    }\n\n    return `${trimmedMonth} / ${trimmedYear}`;\n}\n","import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\n\nexport interface CreditCardNameFieldProps {\n    name: string;\n}\n\nconst CreditCardNameField: FunctionComponent<CreditCardNameFieldProps> = ({ name }) => {\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => <TextInput {...field} autoComplete=\"cc-name\" id={field.name} />,\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"payment.credit_card_name_label\" />,\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccName\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default memo(CreditCardNameField);\n","import creditCardType from 'credit-card-type';\nimport { type FieldProps } from 'formik';\nimport { max } from 'lodash';\nimport React, {\n    type ChangeEventHandler,\n    type FunctionComponent,\n    memo,\n    type ReactElement,\n    useCallback,\n    useEffect,\n    useMemo,\n    useRef,\n} from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\nimport { IconLock } from '../../ui/icon';\n\nimport formatCreditCardNumber from './formatCreditCardNumber';\n\nexport interface CreditCardNumberFieldProps {\n    name: string;\n}\n\nconst CreditCardNumberField: FunctionComponent<CreditCardNumberFieldProps> = ({ name }) => {\n    const renderInput = useCallback(\n        ({ field, form }: FieldProps<string>) => (\n            <CreditCardNumberInput field={field} form={form} />\n        ),\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"payment.credit_card_number_label\" />,\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccNumber\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\ninterface CreditCardNumberInputProps {\n    field: FieldProps<string>['field'];\n    form: FieldProps<string>['form'];\n}\n\nconst CreditCardNumberInput: FunctionComponent<CreditCardNumberInputProps> = ({ field, form }): ReactElement => {\n    const inputRef = useRef<HTMLInputElement>(null);\n    const nextSelectionEndRef = useRef(0);\n\n    useEffect(() => {\n        if (inputRef.current && inputRef.current.selectionEnd !== nextSelectionEndRef.current) {\n            inputRef.current.setSelectionRange(nextSelectionEndRef.current, nextSelectionEndRef.current);\n        }\n    });\n\n    const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n        (event) => {\n            const separator = ' ';\n            const { value = '' } = event.target;\n            const { name, value: previousValue = '' } = field;\n            const selectionEnd = inputRef.current && inputRef.current.selectionEnd;\n\n            // Only allow digits and spaces\n            if (new RegExp(`[^\\\\d${separator}]`).test(value)) {\n                return form.setFieldValue(name, previousValue);\n            }\n\n            const maxLength = max(creditCardType(value).map((info) => max(info.lengths)));\n\n            const formattedValue = formatCreditCardNumber(\n                value.replace(new RegExp(separator, 'g'), '').slice(0, maxLength),\n                separator,\n            );\n\n            if (selectionEnd === value.length && value.length < formattedValue.length) {\n                nextSelectionEndRef.current = formattedValue.length;\n            } else {\n                nextSelectionEndRef.current = selectionEnd || 0;\n            }\n\n            void form.setFieldValue(name, formattedValue);\n        },\n        [field, form],\n    );\n\n    return (\n        <>\n            <TextInput\n                {...field}\n                additionalClassName=\"has-icon\"\n                autoComplete=\"cc-number\"\n                id={field.name}\n                onChange={handleChange}\n                ref={inputRef}\n                type=\"tel\"\n            />\n\n            <IconLock />\n        </>\n    );\n};\n\nexport default memo(CreditCardNumberField);\n","import { number } from 'card-validator';\n\nimport unformatCreditCardNumber from './unformatCreditCardNumber';\n\nexport default function formatCreditCardNumber(value: string, separator = ' '): string {\n    const { card } = number(value);\n\n    if (!card) {\n        return value;\n    }\n\n    const unformattedValue = unformatCreditCardNumber(value, separator);\n\n    return card.gaps\n        .filter((gapIndex) => unformattedValue.length > gapIndex)\n        .reduce(\n            (output, gapIndex, index) =>\n                [output.slice(0, gapIndex + index), output.slice(gapIndex + index)].join(separator),\n            unformattedValue,\n        );\n}\n","import React, { type FunctionComponent, memo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { Fieldset, Legend } from '../../ui/form';\n\nimport CreditCardCodeField from './CreditCardCodeField';\nimport CreditCardCustomerCodeField from './CreditCardCustomerCodeField';\nimport CreditCardExpiryField from './CreditCardExpiryField';\nimport CreditCardNameField from './CreditCardNameField';\nimport CreditCardNumberField from './CreditCardNumberField';\n\nexport interface CreditCardFieldsetProps {\n    shouldShowCardCodeField?: boolean;\n    shouldShowCustomerCodeField?: boolean;\n    shouldShowSaveCardField?: boolean;\n}\n\nconst CreditCardFieldset: FunctionComponent<CreditCardFieldsetProps> = ({\n    shouldShowCardCodeField,\n    shouldShowCustomerCodeField,\n}) => (\n    <Fieldset\n        additionalClassName=\"creditCardFieldset\"\n        legend={\n            <Legend hidden>\n                <TranslatedString id=\"payment.credit_card_text\" />\n            </Legend>\n        }\n    >\n        <div className=\"form-ccFields\">\n            <CreditCardNumberField name=\"ccNumber\" />\n\n            <CreditCardExpiryField name=\"ccExpiry\" />\n\n            <CreditCardNameField name=\"ccName\" />\n\n            {shouldShowCardCodeField && <CreditCardCodeField name=\"ccCvv\" />}\n\n            {shouldShowCustomerCodeField && <CreditCardCustomerCodeField name=\"ccCustomerCode\" />}\n        </div>\n    </Fieldset>\n);\n\nexport default memo(CreditCardFieldset);\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { cvv, expirationDate, number } from 'card-validator';\nimport { object, type ObjectSchema, string } from 'yup';\n\nimport { type CreditCardFieldsetValues } from '../paymentMethod';\n\nexport interface CreditCardValidationSchemaOptions {\n    isCardCodeRequired: boolean;\n    language: LanguageService;\n}\n\nexport default memoize(function getCreditCardValidationSchema({\n    isCardCodeRequired,\n    language,\n}: CreditCardValidationSchemaOptions): ObjectSchema<CreditCardFieldsetValues> {\n    const schema = {\n        ccCustomerCode: string(),\n        ccCvv: string(),\n        ccExpiry: string()\n            .required(language.translate('payment.credit_card_expiration_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_expiration_invalid_error'),\n                test: (value) => expirationDate(value).isValid,\n            }),\n        ccName: string()\n            .max(200)\n            .required(language.translate('payment.credit_card_name_required_error')),\n        ccNumber: string()\n            .required(language.translate('payment.credit_card_number_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_number_invalid_error'),\n                test: (value) => number(value).isValid,\n            }),\n    };\n\n    if (isCardCodeRequired) {\n        schema.ccCvv = string()\n            .required(language.translate('payment.credit_card_cvv_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_cvv_invalid_error'),\n                test(value) {\n                    const { card } = number(this.parent.ccNumber);\n\n                    return cvv(value, card && card.code ? card.code.size : undefined).isValid;\n                },\n            });\n    }\n\n    return object(schema);\n});\n","import React from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { CreditCardCodeField, CreditCardNumberField } from '../creditCard';\n\ninterface CreditCardValidationProps {\n    shouldShowCardCodeField: boolean;\n    shouldShowNumberField: boolean;\n}\n\nconst CreditCardValidation: React.FunctionComponent<CreditCardValidationProps> = ({\n    shouldShowNumberField,\n    shouldShowCardCodeField,\n}) => (\n    <>\n        {shouldShowNumberField && (\n            <p>\n                <strong>\n                    <TranslatedString id=\"payment.instrument_trusted_shipping_address_title_text\" />\n                </strong>\n\n                <br />\n\n                <TranslatedString id=\"payment.instrument_trusted_shipping_address_text\" />\n            </p>\n        )}\n\n        <div className=\"form-ccFields\">\n            {shouldShowNumberField && <CreditCardNumberField name=\"ccNumber\" />}\n\n            {shouldShowCardCodeField && <CreditCardCodeField name=\"ccCvv\" />}\n        </div>\n    </>\n);\n\nexport default CreditCardValidation;\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { cvv, number } from 'card-validator';\nimport creditCardType from 'credit-card-type';\nimport { object, type ObjectSchema, string, type StringSchema } from 'yup';\n\nimport type CardInstrumentFieldsetValues from './CardInstrumentFieldsetValues';\nimport mapFromInstrumentCardType from './mapFromInstrumentCardType';\n\nexport interface InstrumentValidationSchemaOptions {\n    instrumentBrand: string;\n    instrumentLast4: string;\n    isCardCodeRequired: boolean;\n    isCardNumberRequired: boolean;\n    language: LanguageService;\n}\n\ninterface InstrumentValidationSchema {\n    ccCvv?: StringSchema;\n    ccNumber?: StringSchema;\n    instrumentId: StringSchema;\n}\n\nexport default memoize(function getInstrumentValidationSchema({\n    instrumentBrand,\n    instrumentLast4,\n    isCardCodeRequired,\n    isCardNumberRequired,\n    language,\n}: InstrumentValidationSchemaOptions): ObjectSchema<CardInstrumentFieldsetValues> {\n    const schema: InstrumentValidationSchema = {\n        instrumentId: string().required(),\n    };\n\n    if (isCardCodeRequired) {\n        schema.ccCvv = string()\n            .required(language.translate('payment.credit_card_cvv_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_cvv_invalid_error'),\n                test(value = '') {\n                    const cardType = mapFromInstrumentCardType(instrumentBrand);\n                    const cardInfo = creditCardType.getTypeInfo(cardType);\n\n                    return cvv(value, cardInfo && cardInfo.code ? cardInfo.code.size : undefined)\n                        .isValid;\n                },\n            });\n    }\n\n    if (isCardNumberRequired) {\n        schema.ccNumber = string()\n            .required(language.translate('payment.credit_card_number_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_number_invalid_error'),\n                test: (value = '') => number(value).isValid,\n            })\n            .test({\n                message: language.translate('payment.credit_card_number_mismatch_error'),\n                test: (value = '') => value.slice(-instrumentLast4.length) === instrumentLast4,\n            });\n    }\n\n    return object(schema);\n});\n","import {\n    type CardInstrument,\n    type CheckoutSelectors,\n    type HostedFieldType,\n    type Instrument,\n    type PaymentInitializeOptions,\n    type PaymentInstrument,\n    type PaymentMethod,\n    type PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { memoizeOne } from '@bigcommerce/memoize';\nimport { find, noop } from 'lodash';\nimport React, { Component, type ReactNode } from 'react';\nimport { type ObjectSchema } from 'yup';\n\nimport { type MapToPropsFactory } from '@bigcommerce/checkout/legacy-hoc';\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { type CheckoutContextProps, type PaymentFormValues } from '@bigcommerce/checkout/payment-integration-api';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { withCheckout } from '../../checkout';\nimport { connectFormik, type ConnectFormikProps } from '../../common/form';\nimport { withForm, type WithFormProps } from '../../ui/form';\nimport {\n    configureCardValidator,\n    CreditCardFieldset,\n    getCreditCardValidationSchema,\n} from '../creditCard';\nimport {\n    CardInstrumentFieldset,\n    type CardInstrumentFieldsetValues,\n    CreditCardValidation,\n    getInstrumentValidationSchema,\n    isCardInstrument,\n    isInstrumentCardCodeRequiredSelector,\n    isInstrumentCardNumberRequiredSelector,\n    isInstrumentFeatureAvailable,\n} from '../storedInstrument';\nimport StoreInstrumentFieldset from '../StoreInstrumentFieldset';\nimport withPayment, { type WithPaymentProps } from '../withPayment';\n\nimport type CreditCardFieldsetValues from './CreditCardFieldsetValues';\n\nexport interface CreditCardPaymentMethodProps {\n    isInitializing?: boolean;\n    isUsingMultiShipping?: boolean;\n    method: PaymentMethod;\n    cardFieldset?: ReactNode;\n    cardValidationSchema?: ObjectSchema;\n    storedCardValidationSchema?: ObjectSchema;\n    deinitializePayment(options: PaymentRequestOptions): Promise<CheckoutSelectors>;\n    getStoredCardValidationFieldset?(selectedInstrument?: CardInstrument): ReactNode;\n    initializePayment(\n        options: PaymentInitializeOptions,\n        selectedInstrument?: CardInstrument,\n    ): Promise<CheckoutSelectors>;\n    onUnhandledError?(error: Error): void;\n}\n\nexport type CreditCardPaymentMethodValues = CreditCardFieldsetValues | CardInstrumentFieldsetValues;\n\ninterface WithCheckoutCreditCardPaymentMethodProps {\n    instruments: CardInstrument[];\n    isCardCodeRequired: boolean;\n    isCustomerCodeRequired: boolean;\n    isInstrumentFeatureAvailable: boolean;\n    isLoadingInstruments: boolean;\n    isPaymentDataRequired: boolean;\n    shouldShowInstrumentFieldset: boolean;\n    isInstrumentCardCodeRequired(instrument: Instrument, method: PaymentMethod): boolean;\n    isInstrumentCardNumberRequired(instrument: Instrument): boolean;\n    loadInstruments(): Promise<CheckoutSelectors>;\n}\n\ninterface CreditCardPaymentMethodState {\n    focusedHostedFieldType?: HostedFieldType;\n    isAddingNewCard: boolean;\n    selectedInstrumentId?: string;\n    isPreloaderOn: boolean;\n}\n\nclass CreditCardPaymentMethod extends Component<\n    CreditCardPaymentMethodProps &\n        WithCheckoutCreditCardPaymentMethodProps &\n        WithFormProps &\n        WithPaymentProps &\n        WithLanguageProps &\n        ConnectFormikProps<PaymentFormValues>,\n    CreditCardPaymentMethodState\n> {\n    state: CreditCardPaymentMethodState = {\n        isAddingNewCard: false,\n        isPreloaderOn: true,\n    };\n\n    async componentDidMount(): Promise<void> {\n        const {\n            initializePayment,\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            loadInstruments,\n            method,\n            onUnhandledError = noop,\n            setValidationSchema,\n        } = this.props;\n\n        setValidationSchema(method, this.getValidationSchema());\n        configureCardValidator();\n\n        try {\n            if (isInstrumentFeatureAvailableProp) {\n                await loadInstruments();\n            }\n\n            await initializePayment(\n                {\n                    gatewayId: method.gateway,\n                    methodId: method.id,\n                },\n                this.getSelectedInstrument(),\n            ).then(() => this.setState({ isPreloaderOn: false }));\n        } catch (error) {\n            onUnhandledError(error);\n        }\n    }\n\n    async componentWillUnmount(): Promise<void> {\n        const {\n            deinitializePayment,\n            method,\n            onUnhandledError = noop,\n            setValidationSchema,\n        } = this.props;\n\n        setValidationSchema(method, null);\n\n        try {\n            await deinitializePayment({\n                gatewayId: method.gateway,\n                methodId: method.id,\n            });\n        } catch (error) {\n            onUnhandledError(error);\n        }\n    }\n\n    async componentDidUpdate(\n        _prevProps: Readonly<CreditCardPaymentMethodProps>,\n        prevState: Readonly<CreditCardPaymentMethodState>,\n    ): Promise<void> {\n        const {\n            deinitializePayment,\n            initializePayment,\n            method,\n            onUnhandledError = noop,\n            setValidationSchema,\n        } = this.props;\n\n        const { isAddingNewCard, selectedInstrumentId } = this.state;\n\n        setValidationSchema(method, this.getValidationSchema());\n\n        if (\n            selectedInstrumentId !== prevState.selectedInstrumentId ||\n            isAddingNewCard !== prevState.isAddingNewCard\n        ) {\n            try {\n                await deinitializePayment({\n                    gatewayId: method.gateway,\n                    methodId: method.id,\n                });\n\n                await initializePayment(\n                    {\n                        gatewayId: method.gateway,\n                        methodId: method.id,\n                    },\n                    this.getSelectedInstrument(),\n                );\n\n            } catch (error) {\n                onUnhandledError(error);\n            }\n        }\n    }\n\n    render(): ReactNode {\n        const {\n            cardFieldset,\n            getStoredCardValidationFieldset,\n            instruments,\n            isInitializing,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredProp,\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredProp,\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            isLoadingInstruments,\n            shouldShowInstrumentFieldset,\n            method,\n        } = this.props;\n\n        const { isAddingNewCard, isPreloaderOn } = this.state;\n\n        const selectedInstrument = this.getSelectedInstrument();\n        const shouldShowCreditCardFieldset = !shouldShowInstrumentFieldset || isAddingNewCard;\n        const isLoading = isInitializing || isLoadingInstruments || isPreloaderOn;\n        const shouldShowNumberField = selectedInstrument\n            ? isInstrumentCardNumberRequiredProp(selectedInstrument)\n            : false;\n        const shouldShowCardCodeField = selectedInstrument\n            ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n            : false;\n\n        return (\n            <LoadingOverlay hideContentWhenLoading isLoading={isLoading}>\n                <div className=\"paymentMethod paymentMethod--creditCard\" data-test='credit-cart-payment-method'>\n                    {shouldShowInstrumentFieldset && (\n                        <CardInstrumentFieldset\n                            instruments={instruments}\n                            onDeleteInstrument={this.handleDeleteInstrument}\n                            onSelectInstrument={this.handleSelectInstrument}\n                            onUseNewInstrument={this.handleUseNewCard}\n                            selectedInstrumentId={\n                                selectedInstrument && selectedInstrument.bigpayToken\n                            }\n                            validateInstrument={\n                                getStoredCardValidationFieldset ? (\n                                    getStoredCardValidationFieldset(selectedInstrument)\n                                ) : (\n                                    <CreditCardValidation\n                                        shouldShowCardCodeField={shouldShowCardCodeField}\n                                        shouldShowNumberField={shouldShowNumberField}\n                                    />\n                                )\n                            }\n                        />\n                    )}\n\n                    {shouldShowCreditCardFieldset && !cardFieldset && (\n                        <CreditCardFieldset\n                            shouldShowCardCodeField={\n                                method.config.cardCode || method.config.cardCode === null\n                            }\n                            shouldShowCustomerCodeField={method.config.requireCustomerCode}\n                        />\n                    )}\n\n                    {shouldShowCreditCardFieldset && cardFieldset}\n\n                    {isInstrumentFeatureAvailableProp && (\n                        <StoreInstrumentFieldset\n                            instrumentId={selectedInstrument && selectedInstrument.bigpayToken}\n                        />\n                    )}\n                </div>\n            </LoadingOverlay>\n        );\n    }\n\n    private getSelectedInstrument(): CardInstrument | undefined {\n        const { instruments } = this.props;\n        const { selectedInstrumentId = this.getDefaultInstrumentId() } = this.state;\n\n        return find(instruments, { bigpayToken: selectedInstrumentId });\n    }\n\n    private getDefaultInstrumentId(): string | undefined {\n        const { isAddingNewCard } = this.state;\n\n        if (isAddingNewCard) {\n            return;\n        }\n\n        const { instruments } = this.props;\n        const defaultInstrument =\n            instruments.find((instrument) => instrument.defaultInstrument) || instruments[0];\n\n        return defaultInstrument && defaultInstrument.bigpayToken;\n    }\n\n    private getValidationSchema(): ObjectSchema | null {\n        const {\n            cardValidationSchema,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredProp,\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredProp,\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            isPaymentDataRequired,\n            language,\n            method,\n            storedCardValidationSchema,\n        } = this.props;\n\n        if (!isPaymentDataRequired) {\n            return null;\n        }\n\n        const selectedInstrument = this.getSelectedInstrument();\n\n        if (isInstrumentFeatureAvailableProp && selectedInstrument) {\n            return (\n                storedCardValidationSchema ||\n                getInstrumentValidationSchema({\n                    instrumentBrand: selectedInstrument.brand,\n                    instrumentLast4: selectedInstrument.last4,\n                    isCardCodeRequired: isInstrumentCardCodeRequiredProp(\n                        selectedInstrument,\n                        method,\n                    ),\n                    isCardNumberRequired: isInstrumentCardNumberRequiredProp(selectedInstrument),\n                    language,\n                })\n            );\n        }\n\n        return (\n            cardValidationSchema ||\n            getCreditCardValidationSchema({\n                isCardCodeRequired: method.config.cardCode === true,\n                language,\n            })\n        );\n    }\n\n    private handleUseNewCard: () => void = () => {\n        const {\n            formik: { setFieldValue },\n        } = this.props;\n\n        setFieldValue('hostedForm.cardType', '');\n\n        this.setState({\n            isAddingNewCard: true,\n            selectedInstrumentId: undefined,\n        });\n    };\n\n    private handleSelectInstrument: (id: string) => void = (id) => {\n        const {\n            formik: { setFieldValue },\n        } = this.props;\n\n        setFieldValue('hostedForm.cardType', '');\n\n        this.setState({\n            isAddingNewCard: false,\n            selectedInstrumentId: id,\n        });\n    };\n\n    private handleDeleteInstrument: (id: string) => void = (id) => {\n        const {\n            instruments,\n            formik: { setFieldValue },\n        } = this.props;\n        const { selectedInstrumentId } = this.state;\n\n        if (instruments.length === 0) {\n            this.setState({\n                isAddingNewCard: true,\n                selectedInstrumentId: undefined,\n            });\n\n            setFieldValue('instrumentId', '');\n        } else if (selectedInstrumentId === id) {\n            this.setState({\n                selectedInstrumentId: this.getDefaultInstrumentId(),\n            });\n\n            setFieldValue('instrumentId', this.getDefaultInstrumentId());\n        }\n    };\n}\n\nconst mapFromCheckoutProps: MapToPropsFactory<\n    CheckoutContextProps,\n    WithCheckoutCreditCardPaymentMethodProps,\n    CreditCardPaymentMethodProps & ConnectFormikProps<PaymentFormValues>\n> = () => {\n    const filterInstruments = memoizeOne((instruments: PaymentInstrument[] = []) =>\n        instruments.filter(isCardInstrument),\n    );\n\n    return (context, props) => {\n        const { method } = props;\n\n        const { checkoutService, checkoutState } = context;\n\n        const {\n            data: { getConfig, getCustomer, getInstruments, isPaymentDataRequired },\n            statuses: { isLoadingInstruments },\n        } = checkoutState;\n\n        const config = getConfig();\n        const customer = getCustomer();\n\n        if (!config || !customer || !method) {\n            return null;\n        }\n\n        const instruments = filterInstruments(getInstruments(method));\n        const isInstrumentFeatureAvailableProp = isInstrumentFeatureAvailable({\n            config,\n            customer,\n            paymentMethod: method,\n        });\n\n        return {\n            instruments,\n            isCardCodeRequired: method.config.cardCode || method.config.cardCode === null,\n            isCustomerCodeRequired: !!method.config.requireCustomerCode,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredSelector(checkoutState),\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredSelector(checkoutState),\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            isLoadingInstruments: isLoadingInstruments(),\n            isPaymentDataRequired: isPaymentDataRequired(),\n            loadInstruments: checkoutService.loadInstruments,\n            shouldShowInstrumentFieldset:\n                isInstrumentFeatureAvailableProp && instruments.length > 0,\n        };\n    };\n};\n\nexport default connectFormik(\n    withForm(\n        withLanguage(withPayment(withCheckout(mapFromCheckoutProps)(CreditCardPaymentMethod))),\n    ),\n);\n","import { creditCardType } from 'card-validator';\n\nexport default function configureCardValidator(): void {\n    const discoverInfo = creditCardType.getTypeInfo('discover');\n    const visaInfo = creditCardType.getTypeInfo('visa');\n\n    // Need to support 13 digit PAN because some gateways only provide test credit card numbers in this format.\n    creditCardType.updateCard('visa', {\n        lengths: [13, ...(visaInfo.lengths || [])],\n    });\n\n    // Add support for 8-BIN Discover Cards.\n    creditCardType.updateCard('discover', {\n        patterns: [...(discoverInfo.patterns || []), [810, 817]],\n    });\n\n    // Add support for Mada-BIN Cards.\n    creditCardType.addCard({\n        niceType: 'Mada',\n        type: 'mada',\n        patterns: [\n            400861, 401757, 407197, 407395, 409201, 410685, 412565, 417633, 419593, 422817, 422818,\n            422819, 428331, 428671, 428672, 428673, 431361, 432328, 434107, 439954, 440533, 440647,\n            440795, 445564, 446393, 446404, 446672, 455036, 455708, 457865, 458456, 462220, 468540,\n            468541, 468542, 468543, 483010, 483011, 483012, 484783, 486094, 486095, 486096, 489317,\n            489318, 489319, 493428, 504300, 506968, 508160, 513213, 520058, 521076, 524130, 524514,\n            529415, 529741, 530060, 530906, 531095, 531196, 532013, 535825, 535989, 536023, 537767,\n            539931, 543085, 543357, 549760, 554180, 557606, 558848, 585265, 588845, 588846, 588847,\n            588848, 588849, 588850, 588851, 588982, 588983, 589005, 589206, 604906, 605141, 636120,\n            968201, 968202, 968203, 968204, 968205, 968206, 968207, 968208, 968209, 968210, 968211,\n        ],\n        gaps: [4, 8, 12],\n        lengths: [16, 18, 19],\n        code: {\n            name: 'CVV',\n            size: 3,\n        },\n    });\n}\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport {\n    withHostedCreditCardFieldset,\n    type WithInjectedHostedCreditCardFieldsetProps,\n} from '../hostedCreditCard';\n\nimport CreditCardPaymentMethod, { type CreditCardPaymentMethodProps } from './CreditCardPaymentMethod';\n\nexport type HostedCreditCardPaymentMethodProps = Omit<\n    CreditCardPaymentMethodProps,\n    | 'cardFieldset'\n    | 'cardValidationSchema'\n    | 'storedCardValidationSchema'\n    | 'getStoredCardValidationFieldset'\n>;\n\nconst HostedCreditCardPaymentMethod: FunctionComponent<\n    HostedCreditCardPaymentMethodProps & WithInjectedHostedCreditCardFieldsetProps\n> = ({\n    getHostedFormOptions,\n    getHostedStoredCardValidationFieldset,\n    hostedFieldset,\n    hostedStoredCardValidationSchema,\n    hostedValidationSchema,\n    initializePayment,\n    ...rest\n}) => {\n    const initializeHostedCreditCardPayment: CreditCardPaymentMethodProps['initializePayment'] =\n        useCallback(\n            async (options, selectedInstrument) => {\n                return initializePayment({\n                    ...options,\n                    creditCard: getHostedFormOptions && {\n                        form: await getHostedFormOptions(selectedInstrument),\n                    },\n                });\n            },\n            [getHostedFormOptions, initializePayment],\n        );\n\n    return (\n        <CreditCardPaymentMethod\n            {...rest}\n            cardFieldset={hostedFieldset}\n            cardValidationSchema={hostedValidationSchema}\n            getStoredCardValidationFieldset={getHostedStoredCardValidationFieldset}\n            initializePayment={initializeHostedCreditCardPayment}\n            storedCardValidationSchema={hostedStoredCardValidationSchema}\n        />\n    );\n};\n\nexport default withHostedCreditCardFieldset(HostedCreditCardPaymentMethod);\n"],"names":["method","checkoutService","checkoutState","paymentForm","language","onUnhandledError","id","gateway","useHostedCreditCard","setFieldTouched","setFieldValue","setSubmitted","submitForm","config","cardCode","requireCardCode","isCardCodeRequired","isInstrumentCardCodeRequiredProp","isInstrumentCardNumberRequiredProp","getHostedFieldId","useCallback","name","compact","join","focusedFieldType","setFocusedFieldType","useState","getHostedStoredCardValidationFieldset","selectedInstrument","isInstrumentCardNumberRequired","isInstrumentCardCodeRequired","cardCodeId","undefined","cardNumberId","getHostedFormOptions","styleProps","styleContainerId","fields","cardCodeVerification","accessibilityLabel","translate","containerId","instrumentId","bigpayToken","cardNumberVerification","cardExpiry","placeholder","cardName","cardNumber","styles","default","error","Error","focus","Focus","onBlur","fieldType","onCardTypeChange","cardType","onEnter","onFocus","onValidate","errors","forIn","fieldErrors","errorKey","type","CreditCardInputStylesType","getCreditCardInputStyles","properties","Default","container","document","createElement","parentContainer","getElementById","appendChild","Promise","resolve","FormContext","Provider","value","isSubmitted","noop","FormFieldContainer","hasError","TextInput","appearFocused","ref","element","getAppliedStyles","parentElement","removeChild","memo","renderInput","field","labelContent","useMemo","TranslatedString","className","FormField","input","InstrumentSelect","PureComponent","componentDidMount","selectedInstrumentId","this","props","setTimeout","updateFieldValue","componentDidUpdate","prevProps","prevSelectedInstrumentId","componentWillUnmount","render","instruments","onSelectInstrument","onUseNewInstrument","shouldHideExpiryDate","find","DropdownTrigger","dropdown","InstrumentMenu","InstrumentSelectButton","instrument","testId","form","map","key","InstrumentOption","onClick","InstrumentUseNewButton","InstrumentMenuItem","handleClick","mapFromInstrumentCardType","brand","cardInfo","isExpired","expirationDate","month","expiryMonth","year","expiryYear","isValid","CreditCardIcon","data","cardTitle","niceType","endingIn","last4","expiryDate","UntrustedShippingCardVerificationType","onDeleteInstrument","validateInstrument","renderModal","ManageInstrumentsModal","Fieldset","additionalClassName","legend","Legend","hidden","ModalTrigger","modal","BasicFormField","style","display","PROVIDERS_WITHOUT_CARD_CODE","createSelector","cart","getCart","lineItems","paymentMethod","includes","provider","digitalItems","length","giftCertificates","trustedShippingAddress","isVaultingCvvEnabled","untrustedShippingCardVerificationMode","CVV","physicalItems","memoize","shape","hostedForm","required","test","message","isCardExpiryRequired","cardExpiryVerification","withIconContainer","height","viewBox","width","xmlns","d","fill","fillRule","rx","stroke","strokeWidth","x","y","fontFamily","fontSize","fontWeight","letterSpacing","opacity","size","Large","TooltipTrigger","placement","tooltip","additionalFields","cardExpiryId","cardNameId","mapFromCheckoutProps","getConfig","getCustomer","customer","isInstrumentFeatureAvailableProp","isInstrumentFeatureAvailable","autoComplete","withLanguage","handleChange","memoizeOne","event","split","RegExp","trimmedMonth","slice","trimmedYear","formatCreditCardExpiryDate","target","onChange","CreditCardNumberInput","inputRef","useRef","nextSelectionEndRef","useEffect","current","selectionEnd","setSelectionRange","previousValue","maxLength","max","info","lengths","formattedValue","separator","card","number","unformattedValue","unformatCreditCardNumber","gaps","filter","gapIndex","reduce","output","index","formatCreditCardNumber","replace","shouldShowCardCodeField","shouldShowCustomerCodeField","schema","ccCustomerCode","ccCvv","ccExpiry","ccName","ccNumber","parent","cvv","code","shouldShowNumberField","instrumentBrand","instrumentLast4","isCardNumberRequired","CreditCardPaymentMethod","Component","state","isAddingNewCard","isPreloaderOn","handleUseNewCard","formik","setState","handleSelectInstrument","handleDeleteInstrument","getDefaultInstrumentId","initializePayment","loadInstruments","setValidationSchema","getValidationSchema","discoverInfo","creditCardType","getTypeInfo","visaInfo","updateCard","patterns","addCard","configureCardValidator","gatewayId","methodId","getSelectedInstrument","then","deinitializePayment","_prevProps","prevState","cardFieldset","getStoredCardValidationFieldset","isInitializing","isLoadingInstruments","shouldShowInstrumentFieldset","shouldShowCreditCardFieldset","isLoading","LoadingOverlay","hideContentWhenLoading","requireCustomerCode","StoreInstrumentFieldset","defaultInstrument","cardValidationSchema","isPaymentDataRequired","storedCardValidationSchema","getInstrumentValidationSchema","getCreditCardValidationSchema","connectFormik","withForm","withPayment","withCheckout","filterInstruments","isCardInstrument","context","getInstruments","statuses","isCustomerCodeRequired","OriginalComponent","rest","isHostedFormEnabled","hostedFieldset","hostedStoredCardValidationSchema","getHostedInstrumentValidationSchema","hostedValidationSchema","getHostedCreditCardValidationSchema","initializeHostedCreditCardPayment","options","creditCard"],"sourceRoot":""}